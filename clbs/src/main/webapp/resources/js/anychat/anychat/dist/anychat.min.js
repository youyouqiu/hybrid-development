!function(t){t.anychat||(t.anychat={});t.anychat.chatObjEventType=new function(){this.OPEN_CHAT_OBJ="openChatObj"}}(window),function(t){t.anychat||(t.anychat={});t.anychat.getUrlParam=new function(){this.getUrlParam=function(t){for(var e=location.search,i=(e=e.substring(1)).split("&"),s=null,a=0;a<i.length;a++){var n=i[a];if(-1!==n.indexOf(t+"=")){s=n.split("=")[1];break}}return s}}}(window),function(t){t.anychat||(t.anychat={});t.anychat.notificationExt=new function(){this.LOGIN_CHAT_SERVER_SUCCESS="loginChatServerSuccess",this.CHAT_USER_ONLINE="chatUserOnline",this.CHAT_USER_OFFLINE="chatUserOffline",this.CHAT_USER_MESSAGE="chatUserMessage",this.CHAT_GROUP_MESSAGE="chatGroupMessage",this.CHAT_KICK="chatKick",this.AGAIN_CONNECT="againConnect",this.GET_CHAT_LIST="getChatList",this.CHAT_TO_USER_MESSAGE="chatToUserMessage"}}(window),function(t){t.anychat||(t.anychat={});var n=t.anychat.notificationExt,e=t.juggle.webSocketEventType,i=t.juggle.Proxy;t.anychat.loginChatProxy=new function(){i.apply(this),this.url=null,this.webSocketClient=null,this.init=function(t){this.webSocketClient=t,this.webSocketClient.addEventListener(e.getMessage("2"),this.onLoginChatServer,this),this.webSocketClient.addEventListener(e.getMessage("3"),this.onUserOnline,this),this.webSocketClient.addEventListener(e.getMessage("4"),this.onUserOffline,this),this.webSocketClient.addEventListener(e.getMessage("6"),this.onUserMessage,this),this.webSocketClient.addEventListener(e.getMessage("7"),this.onGroupMessage,this),this.webSocketClient.addEventListener(e.getMessage("10"),this.onUserKick,this),this.webSocketClient.addEventListener(e.getMessage("11"),this.onAgainConnect,this),this.webSocketClient.addEventListener(e.getMessage("13"),this.onGetMessage,this),this.webSocketClient.addEventListener(e.getMessage("14"),this.onToUserMessage,this)},this.onLoginChatServer=function(t){this.notifyObservers(this.getNotification(n.LOGIN_CHAT_SERVER_SUCCESS,t.mData))},this.onUserOnline=function(t){this.notifyObservers(this.getNotification(n.CHAT_USER_ONLINE,t.mData))},this.onUserOffline=function(t){this.notifyObservers(this.getNotification(n.CHAT_USER_OFFLINE,t.mData))},this.onUserMessage=function(t){this.notifyObservers(this.getNotification(n.CHAT_USER_MESSAGE,t.mData));var e=t.mData;if(null!==e.message&&void 0!==e.message){for(var i=[],s=0;s<e.message.length;s++){var a=e.message[s];i.push(a.chatId)}this.sendUserMessageReceive(i,e.userId)}},this.onGroupMessage=function(t){this.notifyObservers(this.getNotification(n.CHAT_GROUP_MESSAGE,t.mData));var e=t.mData;null!==e.message&&void 0!==e.message&&this.sendGroupMessageReceive(e.message[e.message.length-1].chatId,e.chatGroupId)},this.onUserKick=function(t){this.notifyObservers(this.getNotification(n.CHAT_KICK,t.mData))},this.onAgainConnect=function(t){this.notifyObservers(this.getNotification(n.AGAIN_CONNECT,t.mData))},this.onGetMessage=function(t){this.notifyObservers(this.getNotification(n.GET_CHAT_LIST,t.mData))},this.onToUserMessage=function(t){this.notifyObservers(this.getNotification(n.CHAT_TO_USER_MESSAGE,t.mData))},this.loginChat=function(t){var e={wsOpCode:1,token:t};this.webSocketClient.send(e)},this.sendMessage=function(t,e,i){var s={wsOpCode:5,chatContent:t,toType:e,toTypeId:i};this.webSocketClient.send(s)},this.getMessage=function(t,e,i,s,a){var n={wsOpCode:12,toType:t,toTypeId:e,chatCreateTime:i,currentPage:s,pageSize:a};this.webSocketClient.send(n)},this.sendUserMessageReceive=function(t,e){var i={wsOpCode:8,messageId:t,userId:e};this.webSocketClient.send(i)},this.sendGroupMessageReceive=function(t,e){var i={wsOpCode:9,endChatId:t,chatGroupId:e};this.webSocketClient.send(i)}}}(window),function(t){t.anychat||(t.anychat={});var i=function(t){return $("<div>").text(t).html()},e=t.anychat.chatObjEventType,s=t.juggle.EventDispatcher;t.anychat.UserObj=function(){this.user=null,this.view=null,this.chatList=[],this.shadow=null,s.apply(this),this.init=function(t){this.user=t,this.createView()},this.createView=function(){var t,e=document.createElement("li");this.user.isOnline||(e.className="downLine_P"),t=null===this.user.userImg||void 0===this.user.userImg||"null"===this.user.userImg?this.user.isOnline?BASE_PATH+"anychat/images/new-default.svg":BASE_PATH+"anychat/images/new-default-offline.svg":this.user.userImg,e.innerHTML='<img src="'+t+'" alt=""/><span class="right-group-user-name" data-title="'+i(this.user.userRealName)+'">'+i(this.user.userRealName)+"</span>",this.view=$(e),this.view.attr("id",this.user.userId)},this.onLine=function(){this.view.removeClass("downLine_P"),this.view.find("img").attr("src",BASE_PATH+"anychat/images/new-default.svg")},this.offLine=function(){this.view.addClass("downLine_P"),this.view.find("img").attr("src",BASE_PATH+"anychat/images/new-default-offline.svg")},this.addOptListener=function(){},this.addClickListener=function(e,i){this.view.on("click",function(t){i.call(e,t)})},this.onClick=function(t){$(".windowL_P li").removeClass("on_P"),this.view.addClass("on_P"),this.dispatchEventWith(e.OPEN_CHAT_OBJ)}}}(window),function(t){t.anychat||(t.anychat={});var e=function(t){return $("<div>").text(t).html()},i=t.anychat.chatObjEventType,s=t.juggle.EventDispatcher;t.anychat.GroupObj=function(){this.group=null,this.view=null,this.chatList=[],s.apply(this),this.init=function(t){this.group=t,this.createView()},this.createView=function(){var t=document.createElement("li");t.className="talkGroup_P",t.innerHTML='<img src="'+BASE_PATH+'anychat/images/new-group.svg" alt=""/><span class="titleSty2_P" data-title="'+e(this.group.chatGroupName)+'">'+e(this.group.chatGroupName)+"</span>",this.view=$(t),this.view.find(".titleSty2_P").mouseenter(function(){var e=$(this);$(this).data("timeout",setTimeout(function(){var t=e.data("title");e.justToolsTip({animation:"moveInTop",width:"auto",contents:t,gravity:"top",distance:20})},3e3))}).mouseleave(function(){clearTimeout($(this).data("timeout"))})},this.addOptListener=function(){this.addClickListener(this,this.onClick)},this.addClickListener=function(e,i){this.view.on("click",function(t){i.call(e,t)})},this.onClick=function(t){$(".windowL_P li").removeClass("on_P"),this.view.addClass("on_P"),this.dispatchEventWith(i.OPEN_CHAT_OBJ)}}}(window),function(c){$.fn.getCursorPosition=function(){var t=$(this).get(0),e=0;if("selectionStart"in t)e=t.selectionStart;else if("selection"in document){t.focus();var i=document.selection.createRange(),s=document.selection.createRange().text.length;i.moveStart("character",-t.value.length),e=i.text.length-s}return e},c.anychat||(c.anychat={});var h=c.anychat.chatObjEventType,s=c.anychat.getUrlParam,e=c.anychat.notificationExt,n=c.anychat.loginChatProxy,l=c.anychat.GroupObj,u=c.anychat.UserObj,t=c.juggle.Mediator,i=c.juggle.WebSocketClient,a=c.juggle.webSocketEventType;c.anychat.TalkMediator=function(){this.webSocketClient=null,this.groupMap={},this.userMap={},this.groupUserMap=[],this.nowToObj=null,this.own=null,this.onlineNum=0,this.userNum=0,this.pageSize=20,this.currentPage=0,this.totalPage=0,this.maxPage=9999,this.nowModule=1,this.token=null,this.lastChatCreateTime=null,this.faceContent=null,this.noticeTimeoutId=null,this.initView=function(t){if(this.token=s.getUrlParam("token"),null!==this.token&&void 0!==this.token){this.loginChatServer(),this.addSendChat(this,this.onSendChat),this.addHistory(this,this.onClickHistory),this.addFirstPage(this,this.onFirstPage),this.addPrePage(this,this.onPrePage),this.addNextPage(this,this.onNextPage),this.addLastPage(this,this.onLastPage),this.addReturnChat(this,this.onReturnChat);var e=parseInt($(".textarea-wrapper textarea").css("line-height"));isNaN(e)&&(e=25),$(".textarea-wrapper").mCustomScrollbar({scrollInertia:0,theme:"minimal",advanced:{autoScrollOnFocus:!1},mouseWheel:{disableOver:["select","option","keygen","datalist",""]},keyboard:{enable:!1},snapAmount:e});var l=$(".textarea-wrapper textarea"),u=($(".textarea-wrapper"),$(".textarea-wrapper .textarea-clone"),this);l.bind("keyup keydown",function(t){if(13===t.keyCode&&!1===t.shiftKey&&"keydown"===t.type)return t.preventDefault(),$("#sendChat").trigger("click"),!1;if(8===t.keyCode&&"keydown"===t.type){var e=$(this),i=e.val(),s=(i.length,l.getCursorPosition()),a=i.substr(0,s),n=i.substr(s,i.length);if(0<a.length){var o=a.length-1;if("]"===a.charAt(o)){var r=a.lastIndexOf("["),h=a.substring(r,o+1);if(u.checkInFace(h)){t.preventDefault();var c=a.substring(0,r)+n;return e.val(c),e[0].selectionEnd=r,!1}}}}u.copyTextarea2Clone()}),$(".windowL_P>dd").mCustomScrollbar({theme:"minimal",advanced:{autoExpandHorizontalScroll:!0},scrollbarPosition:"outside"}),$(".talkCon_P").mCustomScrollbar({theme:"minimal",advanced:{autoExpandHorizontalScroll:!0},scrollbarPosition:"outside"}),$(".hisList_P").mCustomScrollbar({theme:"minimal",advanced:{autoExpandHorizontalScroll:!0},scrollbarPosition:"outside"});var i=$("#tipContent").html();$(".tips_P").mouseover(function(){var t=$(this);$(".face_P").removeClass("active"),t.justToolsTip({animation:"moveInTop",width:"auto",contents:i,gravity:"top",distance:30})}),$(".face_P").click(function(t){t.stopPropagation();var e=$(this);e.hasClass("active")?e.removeClass("active"):e.addClass("active"),e.justToolsTip({animation:"moveInTop",width:"auto",contents:u.faceContent,gravity:"top",distance:30,events:"click",onRemove:function(){e.removeClass("active")}}),$(".emoji_face a,.favor-item span").on("click",function(){var t=$("#sendChatContent"),e=$(this),i=e.attr("title"),s=t.val(),a=(s.length,t.getCursorPosition()),n=s.substr(0,a)+i+s.substr(a,s.length);t.val(n),e[0].selectionEnd=a+i.length,u.copyTextarea2Clone()}),$(".tab-icon").click(function(){var t=$(this);if(!t.hasClass("active")){var e=t.data("target");$(".tab-icon").removeClass("active"),$(".tab-content").removeClass("active"),t.addClass("active"),$(e).addClass("active")}})}),$(".close,.close-window").click(function(){c.top&&c.top.pagesNav&&c.top.pagesNav.closeChat()}),this.initFace()}},this.notice=function(t,e,i){var s=t,a=i||3e3,n=['<div class="prompt-container">','<span class="prompt-wraper">','<i class="prompt-icon"></i>',"$msg","</span>","</div>"].join(""),o=$(".funList_PJY");o.find(".prompt-container").remove(),o.append($(n.replace("$msg",s))),this.noticeTimeoutId&&clearTimeout(this.noticeTimeoutId),this.noticeTimeoutId=setTimeout(function(){$(".funList_PJY").find(".prompt-container").remove()},a)},this.initFace=function(){for(var t=c.anychat.faceJson.FACE_JSON,e=$(".emoji_face"),i=$(".favor-container"),s=0;s<t.length;s++){var a,n=t[s],o=n.type,r=Object.keys(n)[0],h=n[r];"gif"===o?(a='<div class="favor-item"><span title="$name" class="select-favor-span $className"></span></div>'.replace("$name",r).replace("$className",h),i.append($(a))):(a='<a title="$name" type="emoji" class="face $className"></a>'.replace("$name",r).replace("$className",h),e.append($(a)))}this.faceContent=$("#faceContent").html(),$("#faceContent").remove()},this.copyTextarea2Clone=function(t){var e=function(t){return $("<div>").text(t).html()},i=$(".textarea-wrapper textarea"),s=$(".textarea-wrapper"),a=$(".textarea-wrapper .textarea-clone"),n=parseInt($(".textarea-wrapper textarea").css("line-height"));isNaN(n)&&(n=25);var o=i.val(),r=(o.length,i.getCursorPosition());o=(o="<span>"+e(o.substr(0,r))+e(o.substr(r,o.length))+"</span>").replace(/\n/g,"<br />"),a.html(o),i.css("height",a.height());var h=a.children("span").height(),c=parseInt(a.css("min-height"))-0,l=Math.round(h+s.find(".mCSB_container").position().top);(c<l||l<0)&&(0<h-0?s.mCustomScrollbar("scrollTo",-0-n):s.mCustomScrollbar("scrollTo","top"))},this.addSendChat=function(e,i){$("#sendChat").on("click",function(t){i.call(e,t)})},this.addHistory=function(e,i){$(".history_P").on("click",function(t){i.call(e,t)})},this.addFirstPage=function(e,i){$("#firstPage").on("click",function(t){i.call(e,t)})},this.addPrePage=function(e,i){$("#prePage").on("click",function(t){i.call(e,t)})},this.addNextPage=function(e,i){$("#nextPage").on("click",function(t){i.call(e,t)})},this.addLastPage=function(e,i){$("#lastPage").on("click",function(t){i.call(e,t)})},this.addReturnChat=function(e,i){$("#returnChat").on("click",function(t){i.call(e,t)})},this.loginChatServer=function(){this.logoutChatServer(),this.webSocketClient=new i(n.url),this.webSocketClient.addEventListener(a.CONNECTED,this.onConnected,this),this.webSocketClient.addEventListener(a.CLOSE,this.onClose,this),n.init(this.webSocketClient)},this.onClose=function(t){},this.logoutChatServer=function(){null!==this.webSocketClient&&void 0!==this.webSocketClient&&(this.webSocketClient.close(),this.webSocketClient.removeEventListeners(),this.webSocketClient=null)},this.onConnected=function(t){n.loginChat(this.token)},this.listNotificationInterests=[e.LOGIN_CHAT_SERVER_SUCCESS,e.CHAT_USER_ONLINE,e.CHAT_USER_OFFLINE,e.CHAT_USER_MESSAGE,e.CHAT_GROUP_MESSAGE,e.CHAT_KICK,e.AGAIN_CONNECT,e.GET_CHAT_LIST,e.CHAT_TO_USER_MESSAGE],this.handleNotification=function(t){switch(t.name){case e.LOGIN_CHAT_SERVER_SUCCESS:this.LoginChatServerSuccess(t.body);break;case e.CHAT_USER_ONLINE:this.userOnline(t.body);break;case e.CHAT_USER_OFFLINE:this.userOffline(t.body);break;case e.CHAT_USER_MESSAGE:this.onUserMessage(t.body);break;case e.CHAT_GROUP_MESSAGE:this.onGroupMessage(t.body);break;case e.CHAT_KICK:break;case e.AGAIN_CONNECT:n.loginChat(this.token);break;case e.GET_CHAT_LIST:this.getChatListSuccess(t.body);break;case e.CHAT_TO_USER_MESSAGE:this.onToUserMessage(t.body)}},this.onReturnChat=function(t){this.nowModule=1,$(t.target).parents(".windowR_P.left2_P").hide().prev().show(),$(".talkCon_P").mCustomScrollbar("scrollTo","bottom")},this.setGroupUserMapOnline=function(t){for(var e=0;e<this.groupUserMap.length;e++)for(var i=this.groupUserMap[e].users,s=0;s<i.length;s++){var a=i[s];a.userId===t.user.userId&&(a.isOnline=t.user.isOnline)}},this.checkInCurrentGroup=function(t){for(var e=!1,i=this.nowToObj.group.chatGroupId,s=null,a=0;a<this.groupUserMap.length;a++)if((o=this.groupUserMap[a]).chatGroupId==i){s=o;break}if(s){var n=null;for(a=0;a<s.users.length;a++){var o;if((o=s.users[a]).userId==t.user.userId){n=o;break}}n&&(e=!0)}return e},this.getCurrentGroupUserName=function(){for(var t="",e=this.nowToObj.group.chatGroupId,i=null,s=0;s<this.groupUserMap.length;s++){var a=this.groupUserMap[s];if(a.chatGroupId==e){i=a;break}}return i&&(t=i.users.map(function(t){return t.userRealName}).join(",")),t},this.getOnlineFromArray=function(t){for(var e=0,i=this.nowToObj.group.chatGroupId,s=null,a=0;a<this.groupUserMap.length;a++)if((n=this.groupUserMap[a]).chatGroupId==i){s=n;break}if(s)for(a=0;a<s.users.length;a++){var n;(n=s.users[a]).isOnline&&e++}return e},this.userOnline=function(t){var e=this.userMap[t.chatUser.userId];if(null!=e){if(e.user=t.chatUser,e.user.isOnline=!0,e.onLine(),this.setGroupUserMapOnline(e),!this.checkInCurrentGroup(e))return;this.onlineNum++,$("#currentOnlineGroup").text(this.onlineNum);for(var i,s=$("#talkUserList")[0].childNodes,a=0;a<s.length;a++){var n=s[a];if(null!==n.id&&void 0!==n.id){i=n;break}}null!=i&&i.id!==e.user.userId&&$("#"+i.id).before($("#"+e.user.userId))}},this.userOffline=function(t){var e=this.userMap[t.userId];if(null!=e){if(e.user.isOnline=!1,e.offLine(),this.setGroupUserMapOnline(e),!this.checkInCurrentGroup(e))return;this.onlineNum--,$("#currentOnlineGroup").text(this.onlineNum);for(var i,s=$("#talkUserList")[0].childNodes,a=s.length-1;0<=a;a--){var n=s[a];if(null!==n.id&&void 0!==n.id){i=n;break}}null!=i&&i.id!==e.user.userId&&$("#"+i.id).after($("#"+e.user.userId))}},this.LoginChatServerSuccess=function(t){var e,i=function(t){t.userGroupList||(t.userGroupList=[]);for(var e=0;e<t.userGroupList.length;e++)for(var i=t.userGroupList[e],s=0;s<this.groupUserMap.length;s++)if(this.groupUserMap[s].chatGroupId===i)if(this.groupUserMap[s].users){for(var a=!1,n=0;n<this.groupUserMap[s].users.length;n++)if(this.groupUserMap[s].users[n].userId==t.userId){a=!0;break}a||this.groupUserMap[s].users.push(t)}else this.groupUserMap[s].users=[t];var o=new u;o.init(t),this.userMap[t.userId]=o};this.own=t.chatUser,$("#talkList").empty();var s=[];if(null!==t.chatGroupList&&void 0!==t.chatGroupList)for(var a=0;a<t.chatGroupList.length;a++){var n=t.chatGroupList[a];s.push(n.chatGroupId),this.groupUserMap.push(n);var o=new l;o.init(n),this.groupMap[n.chatGroupId]=o,$("#talkList").prepend(o.view),o.addOptListener(),o.addEventListener(h.OPEN_CHAT_OBJ,this.openChatObjHandle,this),0===a&&(e=o)}if(null!==t.chatUserList&&void 0!==t.chatUserList)for(a=0;a<t.chatUserList.length;a++){var r=t.chatUserList[a];i.call(this,r)}i.call(this,this.own),this.showGroupUser({mTarget:e}),this.nowToObj=e,this.nowToObj.view.addClass("on_P"),$("#toTypeName").text(this.nowToObj.group.chatGroupName),$("#toTypeName2").text(this.nowToObj.group.chatGroupName),$("#talkUserList").on("mouseenter",".right-group-user-name",function(){var e=$(this);$(this).data("timeout",setTimeout(function(){var t=e.data("title");e.justToolsTip({animation:"moveInTop",width:"auto",contents:t,gravity:"top",distance:20})},3e3))}).on("mouseleave",".right-group-user-name",function(){clearTimeout($(this).data("timeout"))})},this.showGroupUser=function(t){if(t.mTarget!==this.nowToObj){$("#talkUserList").empty(),this.onlineNum=0;for(var e=t.mTarget.group.users,i=0;i<e.length;i++){var s=e[i],a=null;this.userMap[s.userId]?a=this.userMap[s.userId]:((a=new u).init(s),this.userMap[s.userId]=a),s.isOnline?$("#talkUserList").prepend(a.view):$("#talkUserList").append(a.view),a.addOptListener(),a.addEventListener(h.OPEN_CHAT_OBJ,this.openChatObjHandle,this),s.isOnline&&this.onlineNum++}$("#chatMemberNumber").html("("+e.length+")"),$("#currentOnlineGroup").html(this.onlineNum),$("#allGroupUser").html(e.length),$("#groupUserDD").mCustomScrollbar("scrollTo","top")}},this.nvlName=function(t){return"null"==t.userRealName?t.userId:t.userRealName},this.openChatObjHandle=function(t){t.mTarget!==this.nowToObj&&(this.showGroupUser(t),this.nowToObj=t.mTarget,$("#chatList .mCSB_container")[0].innerHTML="",null!==t.mTarget.user&&void 0!==t.mTarget.user?($("#toTypeName").text(this.nvlName(this.nowToObj)),this.openChat(t.mTarget.chatList),$("#toTypeName2").text(this.nvlName(this.nowToObj))):($("#toTypeName").text(this.nowToObj.group.chatGroupName),this.openChat(t.mTarget.chatList),$("#toTypeName2").text(this.nowToObj.group.chatGroupName)),t.mTarget.view.removeClass("online_P"),2===this.nowModule&&this.getHistoryChatList(this.maxPage))},this.openChat=function(t){for(var e=0;e<t.length;e++){var i,s=t[e];i=s.userId===this.own.userId?this.createOwnChat(s):this.createOtherUserChat(s);var a=s.chatCreateTime;this.renderMsgTime(a),$("#chatList .mCSB_container").append(i)}$(".talkCon_P").mCustomScrollbar("scrollTo","bottom")},this.formatTime=function(t){var e=new Date,i=e.getFullYear(),s=e.getMonth()+1,a=e.getDate(),n=e.getHours(),o=t.getFullYear(),r=t.getMonth()+1,h=t.getDate(),c=t.getHours(),l=t.getMinutes(),u=t.getSeconds(),d=function(){c<10&&(c="0"+c.toString()),l<10&&(l="0"+l.toString()),u<10&&(u="0"+u.toString())};return i===o&&s===r&&a===h?c<=12&&n<=12||12<c&&12<n?(d(),[c,":",l,":",u].join("")):c<=12?(d(),["上午 ",c,":",l,":",u].join("")):(d(),["下午 ",c,":",l,":",u].join("")):(d(),[o,"年",r,"月",h,"日 ",c,":",l,":",u].join(""))},this.renderMsgTime=function(t){var e=!1;this.lastChatCreateTime||(this.lastChatCreateTime=t,e=!0);var i=new Date(t.replace(/-/g,"/")),s=new Date(this.lastChatCreateTime.replace(/-/g,"/")),a=i.getTime(),n=s.getTime();if(1<=parseInt((a-n)/6e4)||e){var o=this.formatTime(i),r=$('<div class="chat-time">$date</div>'.replace("$date",o));$("#chatList .mCSB_container").append(r)}this.lastChatCreateTime=t},this.checkInFace=function(t){for(var e=c.anychat.faceJson.FACE_JSON,i=!1,s=null,a=null,n=0;n<e.length;n++){var o=Object.keys(e[n])[0];if(o===t){i=!0,s=e[n][o],a=e[n].type;break}}return i?[s,a]:i},this.replaceFace=function(t){var e=t,i=e.match(/\[.*?\]/g);if(null!=i&&0<i.length)for(var s=0;s<i.length;s++){var a=i[s],n=this.checkInFace(a);n&&(e=e.replace(a,this.renderFace(n)))}return e},this.renderFace=function(t){var e=t[0];return"gif"===t[1]?'<span class="favor-span '+e+'"></span>':'<span class="emoji-span '+e+'"></span>'},this.createOtherUserChat=function(t){var e,i=document.createElement("div"),s=this.userMap[t.userId];if(!s)return $("<div></div>");i.className="otherAsk_P",e=null===s.user.userImg||void 0===s.user.userImg||"null"===s.user.userImg?BASE_PATH+"anychat/images/new-default.svg":BASE_PATH+s.user.userImg;var a=this.replaceFace(t.chatContent);return i.innerHTML='<a href="javascript:;" class="perPic_P"><img src="'+e+'" alt=""/></a><dl><dt>'+this.nvlName(s.user)+"</dt><dd><span>"+a+'</span></dd></dl><div class="clear"></div>',$(i)},this.createOwnChat=function(t){var e,i=document.createElement("div");i.className="myAsk_P",e=null===this.own.userImg||void 0===this.own.userImg||"null"===this.own.userImg?BASE_PATH+"anychat/images/me.svg":BASE_PATH+this.own.userImg;var s=this.replaceFace(t.chatContent);return i.innerHTML='<a href="javascript:;" class="perPic_P"><img src="'+e+'" alt=""/></a><dl><dd><span>'+s+'</span></dd></dl><div class="clear"></div>',$(i)},this.onUserMessage=function(t){var e=!0;null!==this.nowToObj.user&&void 0!==this.nowToObj.user&&this.nowToObj.user.userId===t.userId&&(this.openChat(t.message),e=!1),e&&this.userMap[t.userId].view.addClass("online_P"),this.userMap[t.userId].chatList=this.userMap[t.userId].chatList.concat(t.message)},this.onToUserMessage=function(t){null!==this.nowToObj.user&&void 0!==this.nowToObj.user&&this.nowToObj.user.userId===t.toUserId&&this.openChat([t.message]),this.userMap[t.toUserId].chatList=this.userMap[t.toUserId].chatList.concat([t.message])},this.onGroupMessage=function(t){this.groupMap[t.chatGroupId]&&c.top&&c.top.pagesNav&&c.top.pagesNav.chatNewMsg();var e=!0;null!==this.nowToObj.group&&void 0!==this.nowToObj.group&&this.nowToObj.group.chatGroupId===t.chatGroupId&&(this.openChat(t.message),e=!1),e&&this.groupMap[t.chatGroupId].view.addClass("online_P"),this.groupMap[t.chatGroupId].chatList=this.groupMap[t.chatGroupId].chatList.concat(t.message)},this.onSendChat=function(t){this.copyTextarea2Clone();var e,i,s=$(".textarea-clone>span").html(),a=$("#sendChatContent").val().trim();if(null===a||""===a||void 0===a)return this.notice("发送消息不能为空，请重新输入"),$("#sendChatContent").val("").css("height","80px"),$(".textarea-clone").html("").css("min-height","80px"),void $("#sendChatContentWraper .mCSB_container").css("top","0px");1e3<a.length?this.notice("发送消息内容不能超过1000字符，请分条发送"):(null!==this.nowToObj.user&&void 0!==this.nowToObj.user?(e=1,i=this.nowToObj.user.userId):(e=2,i=this.nowToObj.group.chatGroupId),n.sendMessage(s,e,i),$("#sendChatContent").val("").css("height","80px"),$(".textarea-clone").html("").css("min-height","80px"),$("#sendChatContentWraper .mCSB_container").css("top","0px"))},this.onClickHistory=function(){$(".windowR_P.left2_P").show().prev().hide(),this.getHistoryChatList(this.maxPage),this.nowModule=2},this.setNowTime=function(){var t,e,i,s=(i=new Date).getFullYear(),a=i.getMonth()+1;t=a<10?"0"+a:a,e=(i=i.getDate())<10?"0"+i:i,$("#historyTime").text(s+"-"+t+"-"+e)},this.createHistoryChat=function(t){var e,i=document.createElement("div");i.className="otherAsk_P history-item",e=t.userId===this.own.userId?this.own:this.userMap[t.userId].user;var s=BASE_PATH+"anychat/images/me.svg",a="";t.userId!==this.own.userId?s=BASE_PATH+"anychat/images/new-default.svg":a="history-me";var n=this.replaceFace(t.chatContent),o=this.formatTime(new Date(t.chatCreateTime.replace(/-/g,"/")));return i.innerHTML='<a href="javascript:;" class="perPic_P"><img src="'+s+'" alt=""/></a><dl><dt class="'+a+'">'+this.nvlName(e)+'<span class="history-time">'+o+"</span></dt><dd><div>"+n+'</div></dd></dl><div class="clear"></div>',$(i)},this.getChatListSuccess=function(t){if(this.currentPage=t.currentPage,this.totalPage=t.totalPage,$("#firstPage").removeClass("disabled_P"),$("#prePage").removeClass("disabled_P"),$("#nextPage").removeClass("disabled_P"),$("#lastPage").removeClass("disabled_P"),this.currentPage!==this.totalPage&&null!==this.totalPage&&void 0!==this.totalPage||($("#nextPage").addClass("disabled_P"),$("#lastPage").addClass("disabled_P")),1===this.currentPage&&($("#firstPage").addClass("disabled_P"),$("#prePage").addClass("disabled_P")),$("#histortChat").text(""),null!==t.message&&void 0!==t.message&&0!==t.message.length)for(var e=0;e<t.message.length;e++){var i=t.message[e],s=this.createHistoryChat(i);if($("#histortChat").append(s),0===e){var a=i.chatCreateTime.split(" ");$("#historyTime").text(a[0])}}else this.setNowTime()},this.onFirstPage=function(){this.getHistoryChatList(1)},this.onPrePage=function(){this.getHistoryChatList(this.currentPage-1)},this.onNextPage=function(){this.getHistoryChatList(this.currentPage+1)},this.onLastPage=function(){this.getHistoryChatList(this.maxPage)},this.getHistoryChatList=function(t,e){var i,s;null!==this.nowToObj.user&&void 0!==this.nowToObj.user?(i=1,s=this.nowToObj.user.userId):(i=2,s=this.nowToObj.group.chatGroupId),n.getMessage(i,s,e,t,this.pageSize)},t.apply(this)}}(window),function(t){t.anychat||(t.anychat={});t.anychat.faceJson=new function(){this.FACE_JSON=[{"[大笑]":"emoji0"},{"[口罩]":"emoji1"},{"[激动]":"emoji2"},{"[吐舌头]":"emoji3"},{"[傻呆]":"emoji4"},{"[惊恐]":"emoji5"},{"[忧郁]":"emoji6"},{"[不屑]":"emoji7"},{"[嘿哈]":"emoji8"},{"[捂脸]":"emoji9"},{"[奸笑]":"emoji10"},{"[机智]":"emoji11"},{"[皱眉]":"emoji12"},{"[耶]":"emoji13"},{"[幽灵]":"emoji14"},{"[祈祷]":"emoji15"},{"[给力]":"emoji16"},{"[派对]":"emoji17"},{"[礼物]":"emoji18"},{"[红包]":"emoji19"},{"[小鸡]":"emoji20"},{"[可爱]":"emoji21"},{"[开心]":"emoji22"},{"[羞涩]":"emoji23"},{"[眉眼]":"emoji24"},{"[色眯眯]":"emoji25"},{"[飞吻]":"emoji26"},{"[亲亲]":"emoji27"},{"[嘻嘻]":"emoji28"},{"[害羞]":"emoji29"},{"[鬼脸]":"emoji30"},{"[坏笑]":"emoji31"},{"[汗]":"emoji32"},{"[囧]":"emoji33"},{"[抓狂]":"emoji34"},{"[伤心]":"emoji35"},{"[紧张]":"emoji36"},{"[吃惊]":"emoji37"},{"[困惑]":"emoji38"},{"[失望]":"emoji39"},{"[大哭]":"emoji40"},{"[刺瞎]":"emoji41"},{"[生气]":"emoji42"},{"[愤怒]":"emoji43"},{"[困]":"emoji44"},{"[恶魔]":"emoji45"},{"[外星人]":"emoji46"},{"[心动]":"emoji47"},{"[心碎]":"emoji48"},{"[一见钟情]":"emoji49"},{"[闪光]":"emoji50"},{"[星星]":"emoji51"},{"[感叹]":"emoji52"},{"[疑问]":"emoji53"},{"[睡觉觉]":"emoji54"},{"[口水]":"emoji55"},{"[音乐]":"emoji56"},{"[火]":"emoji57"},{"[大便]":"emoji58"},{"[厉害]":"emoji59"},{"[鄙视]":"emoji60"},{"[揍你]":"emoji61"},{"[胜利]":"emoji62"},{"[向上]":"emoji63"},{"[向下]":"emoji64"},{"[向右]":"emoji65"},{"[向左]":"emoji66"},{"[食指]":"emoji67"},{"[强]":"emoji68"},{"[OK]":"emoji69"},{"[偷笑]":"favor1",type:"gif"},{"[鼓掌]":"favor2",type:"gif"},{"[怒火]":"favor3",type:"gif"},{"[再见]":"favor4",type:"gif"},{"[白眼]":"favor5",type:"gif"},{"[MUA]":"favor6",type:"gif"},{"[色色]":"favor7",type:"gif"},{"[开怀大笑]":"favor8",type:"gif"}]}}(window);